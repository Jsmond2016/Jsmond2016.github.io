(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{495:function(t,a,e){"use strict";e.r(a);var s=e(0),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"_1-如何发请求？"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-如何发请求？"}},[t._v("#")]),t._v(" 1.如何发请求？")]),t._v(" "),e("p",[t._v("我们知道有几种方式可以发请求，但是都有其局限性，如下：")]),t._v(" "),e("blockquote",[e("p",[t._v("用 form 可以发请求，但是会"),e("em",[t._v("刷新页面或新开页面")])]),t._v(" "),e("p",[t._v("用 a 可以发 get 请求，但是也会"),e("em",[t._v("刷新页面或新开页面")])]),t._v(" "),e("p",[t._v("用 img 可以发 get 请求，但是"),e("em",[t._v("只能以图片的形式展示")])]),t._v(" "),e("p",[t._v("用 link 可以发 get 请求，但是"),e("em",[t._v("只能以 CSS、favicon 的形式展示")])]),t._v(" "),e("p",[t._v("用 script 可以发 get 请求，但是"),e("em",[t._v("只能以脚本的形式运行")])])]),t._v(" "),e("p",[t._v("思考：有没有这样的发请求的方式？")]),t._v(" "),e("blockquote",[e("ol",[e("li",[t._v("get、post、put、delete 请求都行")]),t._v(" "),e("li",[t._v("想以什么形式展示就以什么形式展示")])])]),t._v(" "),e("h2",{attrs:{id:"_2-ajax-的出现"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-ajax-的出现"}},[t._v("#")]),t._v(" 2.AJAX 的出现")]),t._v(" "),e("blockquote",[e("p",[t._v("AJAX即“Asynchronous JavaScript and XML”（异步的JavaScript与XML技术)")])]),t._v(" "),e("h3",{attrs:{id:"_2-1-ajax-的历史"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-ajax-的历史"}},[t._v("#")]),t._v(" 2.1 AJAX 的"),e("a",{attrs:{href:"https://zh.wikipedia.org/zh-hans/AJAX",target:"_blank",rel:"noopener noreferrer"}},[t._v("历史"),e("OutboundLink")],1)]),t._v(" "),e("ul",[e("li",[e("p",[t._v("服务器之殇")]),t._v(" "),e("p",[t._v("​\t上个世纪90年代，几乎所有的网站都由HTML页面实现，服务器处理每一个用户请求都需要重新加载网页。这样的处理方式效率不高。用户的体验是所有页面都会消失，再重新载入，即使只是一部分页面元素改变也要重新载入整个页面，不仅要刷新改变的部分，连没有变化的部分也要刷新。这会"),e("strong",[t._v("加重服务器的负担")]),t._v("。")])]),t._v(" "),e("li",[e("p",[t._v("异步加载和iframe方案")]),t._v(" "),e("p",[t._v("​\t这可以用"),e("strong",[t._v("异步加载")]),t._v("来解决。1995年，JAVA语言的第一版发布，随之发布的的Java applets（JAVA小程序）首次实现了异步加载。浏览器通过"),e("em",[t._v("运行嵌入网页中的Java applets与服务器交换数据，不必刷新网页")]),t._v("。1996年，Internet Explorer将"),e("strong",[t._v("iframe元素")]),t._v("加入到HTML，支持局部刷新网页。")])]),t._v(" "),e("li",[e("p",[t._v("XMLHttp 的出现")]),t._v(" "),e("p",[t._v("​\t1998年前后，Outlook Web Access小组写成了允许客户端脚本发送HTTP请求（"),e("strong",[t._v("XMLHTTP")]),t._v("）的第一个组件。该组件原属于微软Exchange Server，并且迅速地成为了Internet Explorer 4.0[2]的一部分。部分观察家认为，Outlook Web Access是第一个应用了Ajax技术的成功的商业应用程序，并成为包括Oddpost的网络邮件产品在内的许多产品的领头羊。但是，2005年初，许多事件使得Ajax被大众所接受。Google在它著名的交互应用程序中使用了异步通讯，如Google讨论组、Google地图、Google搜索建议、Gmail等。Ajax这个词由《Ajax: A New Approach to Web Applications》一文所创，该文的迅速流传提高了人们使用该项技术的意识。另外，对Mozilla/Gecko的支持使得该技术走向成熟，变得更为简单易用。")])]),t._v(" "),e("li",[e("p",[t._v("总结为：")]),t._v(" "),e("blockquote",[e("p",[t._v("IE 5 率先在 JS 中引入 ActiveX 对象（API），使得 JS 可以直接发起 HTTP 请求。\n随后 Mozilla、 Safari、 Opera 也跟进（抄袭）了，取名 XMLHttpRequest，并被纳入 W3C 规范")])])])]),t._v(" "),e("h3",{attrs:{id:"_2-2-ajax-的优缺点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-ajax-的优缺点"}},[t._v("#")]),t._v(" 2.2 AJAX 的优缺点")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("优点")]),t._v(" "),e("p",[t._v("​\t（1）实现局部更新：")]),t._v(" "),e("p",[t._v("​\t就是能在不更新整个页面的前提下维护数据。这使得Web应用程序更为迅捷地回应用户动作，并避免了在网络上发送那些没有改变的信息。")]),t._v(" "),e("p",[t._v("​\t（2）仅依赖于浏览器和JavaScript：")]),t._v(" "),e("p",[t._v("​\tAjax不需要任何浏览器插件，但需要用户允许JavaScript在浏览器上执行。就像DHTML应用程序那样，Ajax应用程序必须在众多不同的浏览器和平台上经过严格的测试。随着Ajax的成熟，一些简化Ajax使用方法的程序库也相继问世。同样，也出现了另一种辅助程序设计的技术，为那些不支持JavaScript的用户提供替代功能。")])]),t._v(" "),e("li",[e("p",[t._v("缺点")]),t._v(" "),e("p",[t._v("​\t（1）浏览器的兼容问题：")]),t._v(" "),e("p",[t._v("​\t\tAjax在本质上是一个浏览器端的技术，首先面临无可避免的第一个问题即是浏览器的兼容性问题。各家浏览器对于JavaScript／DOM／CSS的支持总有部分不太相同或是有Bug，甚至同一浏览器的各个版本间对于JavaScript／DOM／CSS的支持也有可能部分不一样。这导致程序员在写Ajax应用时花大部分的时间在调试浏览器的兼容性而非在应用程序本身。因此，目前大部分的Ajax链接库或开发框架大多以js链接库的形式存在，以定义更高阶的JavaScript API、JavaScript对象（模板）、或者JavaScript Widgets来解决此问题。")]),t._v(" "),e("p",[t._v("​\t（2）局部刷新带来的问题：")]),t._v(" "),e("p",[t._v("​\tAjax技术之主要目的在于局部交换客户端及服务器之间的数据。如同传统之主从架构，无可避免的会有部分的业务逻辑会实现在客户端，或部分在客户端部分在服务器。由于业务逻辑可能分散在客户端及服务器，且以不同之程序语言实现，这导致Ajax应用程序极难维护。如有用户接口或业务逻辑之更动需求，再加上前一个JavaScript/DOM/CSS 之兼容性问题，Ajax应用往往变成程序员的梦魇。")])])]),t._v(" "),e("h2",{attrs:{id:"_3-ajax-的-使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-ajax-的-使用"}},[t._v("#")]),t._v(" 3.AJAX 的 "),e("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用"),e("OutboundLink")],1)]),t._v(" "),e("h3",{attrs:{id:"_3-1-ajax的原理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-ajax的原理"}},[t._v("#")]),t._v(" 3.1 AJAX的原理")]),t._v(" "),e("ol",[e("li",[t._v("使用 XMLHttpRequest 发请求")]),t._v(" "),e("li",[t._v("服务器返回 XML 格式的字符串")]),t._v(" "),e("li",[t._v("JS 解析 XML，并更新局部页面")])]),t._v(" "),e("h3",{attrs:{id:"_3-2-ajax-的目的："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-ajax-的目的："}},[t._v("#")]),t._v(" 3.2 AJAX  的目的：")]),t._v(" "),e("blockquote",[e("p",[t._v("使用 js 发请求 ，使用 js 处理返回的响应。")])]),t._v(" "),e("h3",{attrs:{id:"_3-3-请用原生-js写出一个ajax请求："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-请用原生-js写出一个ajax请求："}},[t._v("#")]),t._v(" 3.3 请用原生 JS写出一个AJAX请求：")]),t._v(" "),e("div",{staticClass:"language-html extra-class"},[e("pre",{pre:!0,attrs:{class:"language-html"}},[e("code",[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("button"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("点我"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),e("span",{pre:!0,attrs:{class:"token script"}},[e("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n\t\tbutton"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" request "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\trequest"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("method"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("address"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\trequest"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\treqeust"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("onreadystatechange")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" reuest"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t\t"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" string "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" esponseText\n\t\t\t\t\t\t"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" object "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("window"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("string"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n\t\t\t\t\t"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t\t"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t\t"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t")])]),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),e("p",[t._v("分析：")]),t._v(" "),e("ul",[e("li",[e("p",[e("code",[t._v("let request = new XMLHttpRequest()")]),t._v("  创建一个AJAX实例")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("request.open(method,address)")]),t._v(" 初始化请求，一般有3个参数 ，如果没有设置就是 默认值\n"),e("code",[t._v("request.open(method,url,async)")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("method")]),t._v(" ：请求的类型；GET 或 POST")]),t._v(" "),e("li",[e("code",[t._v("url")]),t._v(" ： 文件在服务器上的位置")]),t._v(" "),e("li",[e("code",[t._v("async")]),t._v(" ：true（异步）或 false（同步）")])])]),t._v(" "),e("li",[e("p",[e("code",[t._v("request.send()")]),t._v(" 发送请求(如果参数为String，只能为 post请求)")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("reqeust.onreadystatechange()")]),t._v(" 监听 "),e("code",[t._v("readystatue")]),t._v(" 的变化 ，每当 readyState 改变时，就会触发 onreadystatechange 事件。")]),t._v(" "),e("ul",[e("li",[e("p",[e("code",[t._v("request.readyState")]),t._v("  XMLHttpRequest 的状态。从 0 到 4 发生变化")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("值")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("readyState 状态")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("意义")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("UNSENT")]),t._v("(未打开)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("open()")]),t._v("方法还未被调用，请求未初始化")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("OPENED")]),t._v("  (未发送)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("open()")]),t._v("方法已经被调用，  服务器连接已建立")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("HEADERS_RECEIVED (已获取响应头)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("send()")]),t._v("方法已经被调用, 响应头和响应状态已经返回.请求已接收")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("LOADING (正在下载响应体)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("响应体下载中; "),e("code",[t._v("responseText")]),t._v("中已经获取了部分数据.")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("DONE (请求完成)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("整个请求过程已经完毕.")])])])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("request.status")]),t._v(" 200表示OK；404表示未找到页面。")])])])])])]),t._v(" "),e("p",[t._v("参考文章：")]),t._v(" "),e("p",[t._v("​\t"),e("a",{attrs:{href:"https://www.ibm.com/developerworks/cn/xml/wa-ajaxintro1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Ajax 入门简介"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("​\t"),e("a",{attrs:{href:"http://javascript.ruanyifeng.com/bom/ajax.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("AJAX-阮一峰"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("​\t"),e("a",{attrs:{href:"https://www.zhihu.com/question/31592553",target:"_blank",rel:"noopener noreferrer"}},[t._v("为什么form表单提交没有跨域问题，但ajax提交有跨域问题？"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("​\t"),e("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest",target:"_blank",rel:"noopener noreferrer"}},[t._v("XMLHttpRequest-MDN"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("​\t"),e("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/Guide/AJAX",target:"_blank",rel:"noopener noreferrer"}},[t._v("AJAX-MDN"),e("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);